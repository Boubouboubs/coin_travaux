<div class="d-flex bg-info px-4 pt-3">

  <div>
    <%= simple_form_for :filters, url: project_companies_path, method: :get do |f| %>
      <%= f.input :star_rating,
        collection: [["1 étoile", 1], ["2 étoiles", 2], ["3 étoiles", 3], ["4 étoiles", 4], ["5 étoiles", 5]],
        label: false,
        include_blank: "Note",
        selected: params.dig(:filters, :star_rating) %>
  </div>
    <div class="ms-3">
      <%= f.input :review_number,
        collection: [[">5", 5], [">10", 10], [">50", 50]],
        label: false,
        include_blank: "Nombre d'avis",
        selected: params.dig(:filters, :review_number) %>
    </div>
    <div>
      <%= f.input :photo,
        collection: [true, false],
        as: :boolean, input_html: { class: "toggle" },
        selected: params.dig(:filters, :photo) %>
    </div>
    <%# <div>
      <%= f.input :existence_years,
      collection: [["2 à 5 ans", 2], ["5 à 10 ans", 5], [">10 ans", 10]],
      label: false,
      include_blank: "Ancienneté",
      selected: params.dig(:filters, :existence_years) %>
    <%# </div>
    <div> %>
      <%#= f.select :sorting, [:star_rating, :review_number, :existence_years] %>
    <%# </div> %>
      <%#= button_tag(type: "submit", class: "btn btn-search") do %>
          <%# <i class="fa-solid fa-magnifying-glass"></i> %>
      <%# end %>

      <div class="ms-4"><%= f.submit 'Filtrer', class:"btn btn-primary" %></div>
    <% end %>

</div>

<div class="bg-primary px-4 py-1"><em><%= @companies.size %> résultats</em></div>

<div class="container my-5">

  <div class="row d-flex mx-2">
    <% @companies.each do |company| %>
      <div class="col-4 mb-5">
        <%= link_to project_company_path(@project_id, company), style:"text-decoration: none" do %>
          <div class="card-company my-2 mx-5">
            <div class="card-image"><%= cl_image_tag company.project_photo.key, crop: :fill %></div>
            <div class="card-company-infos">
              <h2><%= cl_image_tag company.logo.key, class:"avatar" %> <%= company.name %></h2>
              <div class="d-flex justify-content-between">
                <p><em>
                  <% company.average_rating.round.times do %>
                    <i class="fa-solid fa-star" style="color: #fecc00;"></i>
                  <% end %>
                  <%= company.average_rating %>/5
                </em></p>
              </div>
              <p><%= company.description.truncate(50) %> <strong>voir plus.</strong></p>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>

</div>
